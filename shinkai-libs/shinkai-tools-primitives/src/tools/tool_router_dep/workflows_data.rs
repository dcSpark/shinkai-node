pub static WORKFLOWS_JSON_TESTING: &str = r###"[{"type":"Workflow","content":[{"workflow":{"name":"Extensive_summary","version":"v0.1","steps":[{"name":"Initialize","body":[{"type":"composite","value":[{"type":"registeroperation","value":{"register":"$PROMPT","value":"Summarize this: "}},{"type":"registeroperation","value":{"register":"$EMBEDDINGS","value":{"name":"process_embeddings_in_job_scope","args":[]}}}]}]},{"name":"Summarize","body":[{"type":"registeroperation","value":{"register":"$RESULT","value":{"name":"multi_inference","args":[{"type":"register","value":"$PROMPT"},{"type":"register","value":"$EMBEDDINGS"}]}}}]}],"raw":"\n            workflow Extensive_summary v0.1 {\n                step Initialize {\n                    $PROMPT = \"Summarize this: \"\n                    $EMBEDDINGS = call process_embeddings_in_job_scope()\n                }\n                step Summarize {\n                    $RESULT = call multi_inference($PROMPT, $EMBEDDINGS)\n                }\n            } @@official.shinkai\n        ","description":"Reviews in depth all the content to generate a summary.","author":"@@official.shinkai","sticky":false},"embedding":{"id":"","vector":[0.6820248961448669,0.5723804831504822,0.056784410029649734,-0.029523666948080063,-0.2254689335823059,-0.053013481199741364,-0.6708416938781738,-0.2624345123767853,-0.033756330609321594,0.4013897180557251,-0.16321982443332672,0.971656858921051,0.2718249261379242,0.07108756899833679,0.2820807695388794,0.14116838574409485,-0.11496889591217041,-0.49301284551620483,-1.0789883136749268,-0.043452829122543335,0.19382520020008087,0.5948700308799744,0.6591302156448364,0.16274362802505493,-0.030279342085123062,-0.1913491189479828,-0.3163045048713684,-0.2898331880569458,-0.7694717645645142,-2.4501161575317383,0.5279894471168518,0.0053562745451927185,-0.5002804398536682,-0.5608552694320679,0.028381161391735077,-0.6834791302680969,0.328404039144516,0.2872193455696106,-0.27112722396850586,-0.2420305460691452,-0.20994114875793457,0.23660853505134583,-0.35357770323753357,0.590043306350708,0.27437782287597656,0.06486925482749939,-0.15818193554878235,-0.2542445659637451,0.3756386339664459,0.38245582580566406,-0.45134201645851135,-0.26646173000335693,-0.21188713610172272,0.5074135065078735,-0.45056354999542236,0.42795759439468384,-0.14764094352722168,-0.299643874168396,0.24885445833206177,0.021038610488176346,0.29774922132492065,0.527859091758728,-4.216637134552002,0.35374659299850464,0.19555260241031647,0.3751485049724579,0.17744454741477966,-0.2610761225223541,-0.172037273645401,0.032772570848464966,0.05567239597439766,0.19824181497097015,-0.13289085030555725,-0.1100323274731636,-0.23126265406608582,-0.34616896510124207,0.3950774073600769,0.35234352946281433,0.1308232843875885,-0.6239751577377319,-0.7391460537910461,0.4362350106239319,-0.0347885936498642,0.09445835649967194,-0.2117754966020584,0.7171225547790527,-0.3040316104888916,-0.3600367605686188,0.37041613459587097,-0.06581398844718933,-0.006318345665931702,-0.21981696784496307,-0.002286979928612709,0.2790469229221344,-0.7975400686264038,0.10219541937112808,0.15441451966762543,0.11658502370119095,0.4612636864185333,3.6136317253112793,0.6766623854637146,-0.28591224551200867,0.7045385241508484,-0.4960375726222992,0.1050494909286499,-0.5604535937309265,-0.25389742851257324,-0.2956107258796692,0.40285223722457886,-0.111656554043293,0.015156731009483337,-0.5351597666740417,-0.030287399888038635,0.3177969753742218,0.21704047918319702,0.7171976566314697,-0.46601396799087524,0.3439251184463501,-0.061566051095724106,0.20522497594356537,-0.6280752420425415,0.130172997713089,0.051850613206624985,0.21620029211044312,-0.2943073809146881,0.1809474229812622,-0.23445376753807068,0.2775576710700989,0.2914619445800781,0.0578656867146492,0.10241352021694183,-0.15168319642543793,-0.7568095326423645,0.092719167470932,-0.0777229368686676,-0.15893718600273132,0.5966013073921204,-0.7341698408126831,0.25946319103240967,-0.9252210259437561,0.09058776497840881,-1.5351767539978027,0.7115793824195862,0.29241278767585754,0.7798487544059753,-0.08018416166305542,-0.13354992866516113,-0.08928925544023514,-0.4238916337490082,-0.5697543025016785,0.06765686720609665,0.77348792552948,-0.04202955216169357,0.06487800180912018,0.5874587893486023,-0.11936471611261368,-0.25156763195991516,0.19140180945396423,-0.5563774108886719,0.31181517243385315,-0.32280847430229187,-0.15203385055065155,0.6281672716140747,0.6141714453697205,0.5077856183052063,-0.20541121065616608,0.334749698638916,-0.22992375493049622,0.3473362326622009,0.13209888339042664,-0.046164438128471375,-0.4251396954059601,0.33730384707450867,0.8212467432022095,0.177277609705925,-0.1610117256641388,-0.07467097789049149,0.2908981442451477,0.2191067337989807,-0.5679166316986084,0.7439255714416504,0.5261525511741638,-0.11653833091259003,-0.3659759759902954,-0.023860540241003036,-0.26393836736679077,0.42201778292655945,-0.21162325143814087,0.6553518176078796,0.7129044532775879,-0.8967499136924744,1.4437609910964966,-0.7139504551887512,-0.4562397301197052,0.1866864711046219,-0.1461351215839386,-0.5919792056083679,-0.022950291633605957,0.10381539165973663,0.28671005368232727,-0.5119964480400085,0.06818243861198425,-0.34842413663864136,-0.2360081672668457,-0.20727667212486267,-0.666267454624176,-0.2698496878147125,0.14760757982730865,-0.1733710914850235,-0.7490845322608948,0.17996001243591309,-0.1494026631116867,0.6294229030609131,0.6854228973388672,0.45075780153274536,0.16544346511363983,0.15525199472904205,0.40028688311576843,0.6559727787971497,0.5462879538536072,0.6049190759658813,-0.16969510912895203,-0.5258905291557312,-0.7370105385780334,-0.5058722496032715,0.05097363144159317,-0.4502354860305786,-0.16756923496723175,-0.3616001605987549,-0.07482671737670898,0.5364893674850464,0.3961637616157532,0.6380713582038879,0.7769057154655457,0.45226916670799255,0.12783251702785492,-0.06475261598825455,0.5124138593673706,0.2543259561061859,-0.3266713619232178,0.6652782559394836,-0.10381640493869781,-0.2858583927154541,0.369432270526886,0.4281133711338043,-0.397693008184433,-0.4147809147834778,-0.007397249341011047,-0.16696804761886597,1.8266067504882812,0.09511159360408783,-0.33791670203208923,0.20951442420482635,0.5353755950927734,0.4132263660430908,0.07172563672065735,-1.3672807216644287,0.033725690096616745,-0.6914818286895752,0.4152260720729828,-0.29042062163352966,0.2820392847061157,-0.12484639883041382,0.12444232404232025,-0.2538592219352722,-0.1376664787530899,-0.376803457736969,-0.21342863142490387,-0.3275066018104553,-0.1573990434408188,0.07955310493707657,0.7591940760612488,0.06325787305831909,-0.1243286207318306,-0.06205055117607117,0.27926522493362427,0.1881060153245926,-0.07187489420175552,-0.43998342752456665,-0.04985599219799042,0.35954052209854126,0.07155530899763107,0.37024304270744324,0.25004273653030396,-0.5525103211402893,-0.2558727264404297,-0.36321941018104553,0.04473167657852173,-0.09463290125131607,-0.01605386659502983,-0.21422991156578064,-0.40423282980918884,-0.07233521342277527,0.24171797931194305,1.5734977722167969,0.2532348036766052,0.3514263331890106,0.5783570408821106,0.38809657096862793,0.18779775500297546,-0.7362217903137207,0.018929127603769302,-0.2433643937110901,-0.1767692118883133,-0.6034640073776245,-0.2618042230606079,0.23901714384555817,0.25006982684135437,-0.3671899735927582,0.56818026304245,-0.45649564266204834,-0.5177562832832336,0.21355649828910828,0.04084805026650429,0.36265265941619873,-0.4912548065185547,0.3579895794391632,-0.06822404265403748,0.23526312410831451,-2.4479732513427734,-0.409572571516037,0.33847421407699585,0.39877307415008545,-0.31740933656692505,-0.13011762499809265,1.0355134010314941,-0.2030523419380188,0.004002278670668602,-0.17361848056316376,1.0097349882125854,0.3712850511074066,0.04738866910338402,-0.38382434844970703,-0.22995835542678833,0.10955353826284409,-0.5831428170204163,0.5505454540252686,-0.251912921667099,-0.6052247285842896,-0.11847558617591858,0.39012327790260315,1.722125768661499,0.4369223117828369,0.4068147540092468,-0.08888967335224152,0.16951988637447357,-0.7578551769256592,-1.5347665548324585,-0.09822624921798706,-0.1749330759048462,-0.40222880244255066,0.40935447812080383,-0.014797728508710861,-0.25942203402519226,0.7363397479057312,0.8023666143417358,0.1866847723722458,1.0114266872406006,-0.37116944789886475,1.44536292552948,-0.37696170806884766,-0.06581003218889236,0.011476762592792511,0.43547624349594116,0.33689627051353455,0.4570700526237488,-0.09152284264564514,-0.7278273105621338,-0.19184312224388123,-0.024527274072170258,0.5096248984336853,-0.4112659990787506,0.585030198097229,0.6007319092750549,0.13742738962173462,-0.0392843633890152,0.18517468869686127,0.4498704671859741,0.053321029990911484,0.055953219532966614,-0.3754947781562805,-0.2632603943347931,-0.8821566700935364,-0.5415434241294861]}},true]},{"type":"Workflow","content":[{"workflow":{"name":"Hyde_inference","version":"v0.1","steps":[{"name":"Initialize","body":[{"type":"composite","value":[{"type":"registeroperation","value":{"register":"$PROMPT","value":"write a passage to answer the question: "}},{"type":"registeroperation","value":{"register":"$HYDE_PROMPT","value":{"name":"concat","args":[{"type":"register","value":"$PROMPT"},{"type":"register","value":"$INPUT"}]}}},{"type":"registeroperation","value":{"register":"$HYDE_PASSAGE","value":{"name":"inference_no_ws","args":[{"type":"register","value":"$HYDE_PROMPT"}]}}},{"type":"registeroperation","value":{"register":"$HYDE_INPUT","value":{"name":"concat","args":[{"type":"register","value":"$INPUT"},{"type":"string","value":". "},{"type":"register","value":"$HYDE_PASSAGE"}]}}},{"type":"registeroperation","value":{"register":"$EMBEDDINGS","value":{"name":"search_embeddings_in_job_scope","args":[{"type":"register","value":"$HYDE_INPUT"}]}}}]}]},{"name":"Summarize","body":[{"type":"composite","value":[{"type":"registeroperation","value":{"register":"$CONNECTOR","value":"\\nLeverage the following information to answer the previous query: --- start ---"}},{"type":"registeroperation","value":{"register":"$NEW_INPUT","value":{"name":"concat","args":[{"type":"register","value":"$INPUT"},{"type":"register","value":"$CONNECTOR"},{"type":"register","value":"$EMBEDDINGS"}]}}},{"type":"registeroperation","value":{"register":"$RESULT","value":{"name":"inference","args":[{"type":"register","value":"$NEW_INPUT"}]}}}]}]}],"raw":"\n            workflow Hyde_inference v0.1 {\n                step Initialize {\n                    $PROMPT = \"write a passage to answer the question: \"\n                    $HYDE_PROMPT = call concat($PROMPT, $INPUT)\n                    $HYDE_PASSAGE = call inference_no_ws($HYDE_PROMPT)\n                    $HYDE_INPUT = call concat($INPUT, \". \", $HYDE_PASSAGE )\n                    $EMBEDDINGS = call search_embeddings_in_job_scope($HYDE_INPUT)\n                }\n                step Summarize {\n                    $CONNECTOR = \"\\nLeverage the following information to answer the previous query: --- start ---\"\n                    $NEW_INPUT = call concat($INPUT, $CONNECTOR, $EMBEDDINGS) \n                    $RESULT = call inference($NEW_INPUT)\n                }\n            } @@official.shinkai\n        ","description":"Generates a passage to answer a question and uses embeddings to refine the answer.","author":"@@official.shinkai","sticky":false},"embedding":{"id":"","vector":[-0.04964948445558548,0.07351528108119965,-0.0037448257207870483,-0.5989986658096313,-0.2695397734642029,0.0556429848074913,-0.8189688920974731,0.17371350526809692,-0.042529553174972534,-0.278947651386261,-0.1592383086681366,0.7632817625999451,-0.15512093901634216,0.5815573930740356,0.40833333134651184,0.08403884619474411,0.10889555513858795,-0.09859824180603027,-1.4305481910705566,-0.36282309889793396,0.26563403010368347,0.5795038938522339,0.6247695684432983,0.09672331809997559,0.2193397581577301,-0.3369952440261841,0.45206624269485474,-0.20352067053318024,-0.8568096160888672,-1.5192517042160034,0.45000338554382324,0.1857410967350006,-0.5474480986595154,-0.6226603984832764,-0.3259250521659851,-0.8049982786178589,0.41149431467056274,-0.33869048953056335,-0.40478962659835815,0.14186139404773712,0.08049512654542923,0.12524786591529846,0.05503413826227188,0.5369344353675842,0.22099512815475464,-0.22166168689727783,0.49372294545173645,0.14834408462047577,0.7515535950660706,0.23170407116413116,-0.38584038615226746,-0.6664334535598755,0.08026009798049927,0.05644957721233368,-0.47618070244789124,-0.07221367955207825,-0.013390932232141495,-0.7227036356925964,0.2766876816749573,-0.2050083577632904,0.0018085697665810585,0.36839884519577026,-4.047801494598389,0.25997495651245117,0.6095144748687744,0.29139724373817444,0.1967528611421585,0.33130836486816406,0.10284334421157837,0.6389473080635071,0.3290032148361206,0.469316303730011,-0.6486641764640808,0.9727193713188171,0.1883121132850647,-0.33047881722450256,-0.36619096994400024,0.22055767476558685,0.3932532072067261,-0.5142701864242554,-0.008600234985351562,0.1599426567554474,-0.09545424580574036,0.23433077335357666,-0.042303428053855896,0.7357178926467896,-0.32235464453697205,0.08163000643253326,0.14104235172271729,-0.11884527653455734,-0.03371256962418556,0.0557616725564003,0.3496687710285187,-0.03216787800192833,-0.003476671874523163,0.3798062205314636,0.03774901106953621,0.20039451122283936,-0.3984847366809845,3.36946439743042,-0.13239504396915436,0.001673419028520584,0.7380388379096985,-0.30677103996276855,0.9782622456550598,-0.19148962199687958,-0.3291283845901489,-0.27219173312187195,0.11630738526582718,-0.3731819987297058,0.2829224765300751,-0.5195115208625793,-0.707719087600708,0.13076543807983398,0.09487534314393997,0.3715026080608368,-0.21381931006908417,0.06631460785865784,0.1631127893924713,0.6596425771713257,-0.34905654191970825,0.4622417092323303,-0.2369920015335083,-0.4202103316783905,-0.5958117246627808,-0.0054769366979599,0.05269158259034157,0.3168359696865082,-0.42596322298049927,-0.2948320209980011,0.19625362753868103,0.3843995928764343,-0.7386986017227173,0.29027774930000305,0.38638198375701904,0.398516982793808,0.5393836498260498,-0.7760148644447327,0.026768285781145096,-0.6783398985862732,0.3489813208580017,-1.9833325147628784,0.42915868759155273,-0.3807029724121094,0.7297704219818115,-0.3749578893184662,-0.988932728767395,-0.049560628831386566,-0.748236894607544,-0.39161738753318787,-0.07422567903995514,0.7568775415420532,-0.42796590924263,-0.6895531415939331,0.7455142736434937,0.3727438449859619,-0.302215039730072,-0.2940479516983032,-0.39270395040512085,0.48044177889823914,-0.45199188590049744,0.012708820402622223,-0.014463722705841064,0.38177770376205444,0.41518479585647583,-0.26775816082954407,0.0609671026468277,0.259851336479187,0.5660082101821899,0.28002557158470154,0.2567088007926941,0.08408413827419281,-0.17901833355426788,0.6893192529678345,-0.18076415359973907,-0.1638849675655365,0.7592079639434814,-0.2850896716117859,0.09555481374263763,-0.34255003929138184,0.21607792377471924,0.6083880066871643,-0.27518394589424133,-0.2888985574245453,0.4869835376739502,0.24507123231887817,-0.04523368924856186,0.08955748379230499,0.8814894556999207,0.7514408826828003,-0.7933105826377869,1.4745051860809326,-0.8296284675598145,0.20127254724502563,-0.17663174867630005,0.10280756652355194,0.7590713500976562,0.6627715826034546,0.011114057153463364,-0.21741513907909393,-0.2958572506904602,-0.07200832664966583,-0.028994381427764893,-0.11766113340854645,-0.29194989800453186,-0.8990501165390015,0.22843225300312042,0.3628116250038147,-0.7341636419296265,-0.3731664717197418,-0.16071830689907074,-0.0289015993475914,0.7402246594429016,0.38305380940437317,0.8563412427902222,0.43994849920272827,0.30292415618896484,-0.22889143228530884,0.16537168622016907,0.7458362579345703,0.012104399502277374,-0.15416470170021057,-0.14556102454662323,-0.748606264591217,-0.5879684686660767,0.3174847364425659,-0.35950881242752075,-0.18004687130451202,-0.31736502051353455,-0.17857733368873596,0.23575669527053833,0.9159373044967651,0.2646183967590332,1.1622544527053833,0.6009469628334045,-0.020364172756671906,0.005769722163677216,0.3249523639678955,0.10982750356197357,-0.18247875571250916,-0.018897704780101776,-0.3283432722091675,0.06723657250404358,-0.18632438778877258,0.016186058521270752,-0.299119770526886,0.27416902780532837,-0.4262268543243408,-0.17139290273189545,1.6794452667236328,0.958503246307373,0.46273133158683777,0.3776611387729645,0.4485767185688019,0.4364531934261322,0.14672908186912537,-1.850408911705017,0.0067354487255215645,-0.7456330060958862,0.5802070498466492,0.3341884911060333,-0.7816597819328308,0.8321707248687744,-0.13638745248317719,-0.02185065858066082,-0.4651019871234894,-0.46033725142478943,-0.7211554050445557,-0.36014968156814575,-0.14086481928825378,-0.5944161415100098,0.8056583404541016,-0.7071620225906372,0.3785657584667206,-0.332245409488678,-0.09814120084047318,0.4233565926551819,0.015407413244247437,-0.33447521924972534,-0.4071231186389923,-0.067552350461483,-0.013831926509737968,0.16377918422222137,0.4718702435493469,-0.27083900570869446,-0.020545989274978638,-0.7419271469116211,-0.41673678159713745,-0.10136746615171432,0.2697226405143738,-0.28535905480384827,-0.3748951554298401,-0.7390844821929932,0.034545667469501495,1.644720435142517,-0.009804271161556244,-0.3737269937992096,0.5042737722396851,0.20176424086093903,-0.45157724618911743,-0.029246389865875244,-0.25737810134887695,-0.16420505940914154,0.39507946372032166,-0.6092503666877747,-0.547132134437561,0.49879688024520874,0.050793204456567764,-0.42933282256126404,-0.6348257064819336,-0.5210633873939514,-0.01414722204208374,0.241664320230484,0.07189908623695374,0.6878603100776672,-0.44729337096214294,0.6146893501281738,0.3114408254623413,0.09885749220848083,-2.39998459815979,0.22510097920894623,0.08821532130241394,0.02281942591071129,-0.16851471364498138,-0.39948421716690063,0.4781944751739502,-0.1106119155883789,0.37788909673690796,-0.5341840386390686,1.6657711267471313,0.23619230091571808,-0.16936853528022766,-0.34403157234191895,-0.05048051103949547,0.5156921148300171,-0.5097588300704956,-0.1076057031750679,0.16615211963653564,-0.41826316714286804,-0.09777717292308807,0.4317220151424408,1.4926064014434814,0.4437429904937744,0.6409068703651428,-0.2857368588447571,0.4252455234527588,-0.4507920742034912,-1.395687222480774,0.32343316078186035,-0.14300259947776794,0.17345699667930603,0.6882900595664978,-0.031068190932273865,-0.014234764501452446,0.2588723599910736,0.6380057334899902,-0.10916788876056671,0.21145275235176086,0.41304823756217957,1.875705361366272,0.30104920268058777,-0.14842073619365692,-0.4808446764945984,-0.3084228038787842,-0.2934291660785675,0.12193095684051514,0.18131327629089355,-0.632544219493866,0.30189579725265503,0.13330793380737305,0.1023193746805191,-0.14311614632606506,0.4220004975795746,0.20342287421226501,0.7711853981018066,0.04235168173909187,-0.061884328722953796,1.1321145296096802,-0.16180944442749023,0.008948512375354767,-0.0014485716819763184,-0.1739363670349121,-0.3506462275981903,-0.4292738437652588]}},true]},{"type":"Workflow","content":[{"workflow":{"name":"baml_answer_with_citations","version":"v0.1","steps":[{"name":"Initialize","body":[{"type":"composite","value":[{"type":"registeroperation","value":{"register":"$DSL","value":"class Citation {\n            citation_id int\n            document_reference string @description(#\\\"The name of the document and the page number that supports the answer e.g., FILENAME: Page [PAGE NUMBER]. This is a reference. You must mention it NO MATTER WHAT.\\\"#)\n            relevantTextFromDocument string @alias(\\\"relevantSentenceFromDocument\\\") @description(#\\\"The relevant text from the document that supports the answer. This is part of the citation. You must quote it EXACTLY as it appears in the document with any special characters it contains. You may cite a part of the sentence. The text should be contiguous and not broken up. You may NOT summarize or skip sentences. If you need to skip a sentence, start a new citation instead.\\\"#)\n        }\n\n        class Answer {\n            answersInText Citation[] @alias(\\\"relevantSentencesFromText\\\")\n            answer AnswerWithCitations @description(#\\\"An answer to the user's question that MUST cite sources from the relevantSentencesFromText. Like [0]. If multiple citations are needed, write them like [0][1][2].\\\"#)\n        }\n\n        class AnswerWithCitations {\n            brief_introduction Paragraph @description(#\\\"3-4 long sentences. Must use the citations in the text.\\\"#)\n            extensive_body Paragraph[] @description(#\\\"At least 3-6 long sentences. The more the better. Must use the citations in the text.\\\"#)\n            conclusion Paragraph[] @description(#\\\"1-3 long sentences. Must use the citations in the text.\\\"#)\n        }\n\n        class Paragraph {\n            sentences string[]\n        }\n\n        class Document {\n            file string\n            text string\n            reference string\n        }\n        class Context {\n            documents Document[]\n            question string\n        }\n\n        function AnswerQuestion(context: Context) -> Answer {\n            client ShinkaiProvider\n\n            prompt #\\\"\n                Out of the given content, do your best to answer the question.\n\n                CONTEXT:\n                {% for document in context.documents %}\n                ----\n                DOCUMENT NAME: {{  document.file }}\n                PARTIAL TEXT: {{ document.text }}\n                DOCUMENT REFERENCE: {{ document.reference }}\n                ---\n                {% endfor %}\n                \n                {{ ctx.output_format }}\n\n                QUESTION: {{ context.question }}. Citing the references no matter what e.g., [0]. If multiple citations are needed, write them like [0][1][2].\n\n                ANSWER:\n                {{ _.role(\\\"user\\\") }}\n            \\\"#\n        }"}},{"type":"registeroperation","value":{"register":"$PARAM","value":"context"}},{"type":"registeroperation","value":{"register":"$FUNCTION","value":"AnswerQuestion"}},{"type":"registeroperation","value":{"register":"$RESULT","value":{"name":"baml_inference","args":[{"type":"register","value":"$INPUT"},{"type":"string","value":""},{"type":"string","value":""},{"type":"register","value":"$DSL"},{"type":"register","value":"$FUNCTION"},{"type":"register","value":"$PARAM"}]}}}]}]}],"raw":"\n            workflow baml_answer_with_citations v0.1 {\n                step Initialize {\n                    $DSL = \"class Citation {\n            citation_id int\n            document_reference string @description(#\\\"The name of the document and the page number that supports the answer e.g., FILENAME: Page [PAGE NUMBER]. This is a reference. You must mention it NO MATTER WHAT.\\\"#)\n            relevantTextFromDocument string @alias(\\\"relevantSentenceFromDocument\\\") @description(#\\\"The relevant text from the document that supports the answer. This is part of the citation. You must quote it EXACTLY as it appears in the document with any special characters it contains. You may cite a part of the sentence. The text should be contiguous and not broken up. You may NOT summarize or skip sentences. If you need to skip a sentence, start a new citation instead.\\\"#)\n        }\n\n        class Answer {\n            answersInText Citation[] @alias(\\\"relevantSentencesFromText\\\")\n            answer AnswerWithCitations @description(#\\\"An answer to the user's question that MUST cite sources from the relevantSentencesFromText. Like [0]. If multiple citations are needed, write them like [0][1][2].\\\"#)\n        }\n\n        class AnswerWithCitations {\n            brief_introduction Paragraph @description(#\\\"3-4 long sentences. Must use the citations in the text.\\\"#)\n            extensive_body Paragraph[] @description(#\\\"At least 3-6 long sentences. The more the better. Must use the citations in the text.\\\"#)\n            conclusion Paragraph[] @description(#\\\"1-3 long sentences. Must use the citations in the text.\\\"#)\n        }\n\n        class Paragraph {\n            sentences string[]\n        }\n\n        class Document {\n            file string\n            text string\n            reference string\n        }\n        class Context {\n            documents Document[]\n            question string\n        }\n\n        function AnswerQuestion(context: Context) -> Answer {\n            client ShinkaiProvider\n\n            prompt #\\\"\n                Out of the given content, do your best to answer the question.\n\n                CONTEXT:\n                {% for document in context.documents %}\n                ----\n                DOCUMENT NAME: {{  document.file }}\n                PARTIAL TEXT: {{ document.text }}\n                DOCUMENT REFERENCE: {{ document.reference }}\n                ---\n                {% endfor %}\n                \n                {{ ctx.output_format }}\n\n                QUESTION: {{ context.question }}. Citing the references no matter what e.g., [0]. If multiple citations are needed, write them like [0][1][2].\n\n                ANSWER:\n                {{ _.role(\\\"user\\\") }}\n            \\\"#\n        }\"\n                    $PARAM = \"context\"\n                    $FUNCTION = \"AnswerQuestion\"\n                    $RESULT = call baml_inference($INPUT, \"\", \"\", $DSL, $FUNCTION, $PARAM)\n                }\n            } @@official.shinkai\n        ","description":"Generates an answer to a question with citations from the provided content using BAML. The answer includes quotes from the content as citations.","author":"@@official.shinkai","sticky":false},"embedding":{"id":"","vector":[0.3797622621059418,0.055756017565727234,-0.3101310729980469,-0.1303926408290863,-0.2349807769060135,-0.3620940148830414,-1.4513840675354004,0.4004634618759155,-0.09126128256320953,-0.2862396240234375,-0.21521227061748505,0.5031366348266602,0.5290755033493042,-0.1413222849369049,0.6188375949859619,0.38532504439353943,-0.11255966126918793,-0.5313267707824707,-1.018203854560852,0.16118848323822021,0.38974928855895996,0.26705488562583923,0.7251760363578796,0.3977380394935608,-0.11609482020139694,0.06196017935872078,0.13894720375537872,-0.2236107438802719,-1.2703726291656494,-1.2511805295944214,0.48944661021232605,0.2941161096096039,-0.36227738857269287,-0.2411549985408783,-0.49036508798599243,-0.4147837460041046,0.3464353680610657,-0.19157636165618896,-0.10052890330553055,0.33582234382629395,-0.34775447845458984,0.04653438180685043,0.608782172203064,-0.3258453607559204,-0.12086259573698044,-0.3823518753051758,1.0109241008758545,-0.23640067875385284,0.7499700784683228,0.8023027181625366,-0.3843623101711273,-0.3905274569988251,0.27414560317993164,0.29860666394233704,-0.4371856153011322,0.23716586828231812,0.04210366681218147,0.3562734127044678,-0.331453800201416,0.11200998723506927,0.37262940406799316,-0.3658697307109833,-3.935379981994629,0.14438453316688538,0.6308651566505432,0.21387910842895508,0.28002044558525085,-0.16130675375461578,-0.8150539994239807,-0.4389743506908417,-0.06972597539424896,-0.5424433946609497,-0.7765288949012756,0.5558378100395203,0.3599364161491394,-0.4887274503707886,-0.0007520616054534912,0.05174863338470459,0.590337872505188,-0.384021520614624,-0.053891345858573914,0.3669104278087616,-0.2317630499601364,0.25666916370391846,-0.7620011568069458,0.30930858850479126,-0.21822401881217957,-0.643441379070282,0.44276541471481323,0.660913348197937,-0.4575757086277008,-0.2502431869506836,0.15478183329105377,0.38664811849594116,-0.08887406438589096,0.2539937496185303,-0.03916637599468231,-0.5154840350151062,0.5459664463996887,2.9898178577423096,0.2672237455844879,-0.37507301568984985,0.8107877373695374,-0.5531704425811768,0.7260451912879944,-0.15623879432678223,0.3055795431137085,0.1754366159439087,0.09581713378429413,0.44947704672813416,0.31352749466896057,-0.28868404030799866,-0.5385019779205322,0.33680713176727295,-0.21201713383197784,0.7001216411590576,-0.7345210313796997,0.1426507532596588,0.11188594251871109,0.6378754377365112,0.36010265350341797,0.19299772381782532,-0.19160330295562744,-0.1184423640370369,0.14750339090824127,0.23624475300312042,0.017083611339330673,0.2653906047344208,0.2514684498310089,0.19559024274349213,0.5418351888656616,0.1569286286830902,-0.7294088006019592,0.328125923871994,0.02290940470993519,0.16350258886814117,1.043413758277893,-1.032653570175171,0.9681538343429565,-0.8715519309043884,0.21746881306171417,-1.6401642560958862,0.9072688221931458,0.3240673542022705,0.19921818375587463,-0.22009170055389404,-1.024997353553772,0.3806820213794708,-0.39549684524536133,-0.42126455903053284,-0.37500330805778503,0.12471919506788254,-0.46238279342651367,-0.11431951820850372,0.43173450231552124,-0.08136603981256485,-0.7753247022628784,-0.15560556948184967,-0.20577538013458252,0.16913741827011108,-0.24217629432678223,-0.3097689747810364,0.6912097334861755,-0.46705949306488037,-0.23456573486328125,-0.19368106126785278,-0.026194050908088684,0.29294338822364807,0.20618201792240143,0.038728564977645874,-0.313559353351593,-0.3366357088088989,0.00509969238191843,1.1993379592895508,0.15553726255893707,-0.14727765321731567,0.2659122943878174,-0.15252447128295898,0.7438075542449951,-0.1947561800479889,0.5643417239189148,0.5989380478858948,-0.6331312656402588,-0.3168948292732239,-0.23661555349826813,0.7672645449638367,0.46782436966896057,0.2681032121181488,1.418749451637268,1.2327861785888672,-0.46809977293014526,0.8014423847198486,-0.5430251359939575,-0.3643764853477478,0.15952736139297485,0.19020645320415497,0.7295116782188416,-0.0844498723745346,1.010969638824463,0.24072204530239105,0.3357287049293518,0.020911354571580887,0.2755776643753052,0.02969147264957428,-0.01337328553199768,-0.7969410419464111,-0.47564974427223206,0.5079171061515808,-0.5863653421401978,-0.7805141806602478,-0.10677085816860199,-0.8892369270324707,0.7942572236061096,0.6627474427223206,0.47531434893608093,0.3589997887611389,-0.15228474140167236,-0.10162676870822906,-0.11354662477970123,0.2639334201812744,0.07278834283351898,-0.48128312826156616,-0.8211566805839539,-0.2795396149158478,-0.7236523628234863,0.352206289768219,0.01859442889690399,-0.08775120973587036,-0.22070738673210144,-0.48127979040145874,0.36574625968933105,1.7433961629867554,0.982549786567688,1.0124894380569458,0.7370933890342712,0.4407808184623718,-0.21980562806129456,-0.13790135085582733,0.5385861396789551,-0.4323239326477051,-0.2465112805366516,-0.22517752647399902,-0.0271136611700058,0.26054584980010986,0.44240519404411316,-0.9002771377563477,0.22551384568214417,-0.5237748026847839,0.08540594577789307,1.3925650119781494,0.2770116627216339,-0.5225498676300049,0.44990918040275574,-0.1984628587961197,-0.12113264948129654,0.3022267520427704,-1.8065658807754517,-0.3099088966846466,-0.6861429214477539,0.7306676506996155,-0.30434128642082214,-0.2812166213989258,0.7118960618972778,0.04537050053477287,-0.39949703216552734,-0.9633961915969849,-0.8368886113166809,-1.018973708152771,-0.23503834009170532,-0.07855327427387238,-0.4439423978328705,1.099806547164917,-0.6865937113761902,-0.19636347889900208,0.16010379791259766,0.4755159914493561,0.8275705575942993,0.3734543025493622,-0.19382072985172272,-1.1013609170913696,0.4655303955078125,-0.4615223705768585,0.029980260878801346,-0.12803228199481964,-0.6200829744338989,-0.22082911431789398,-0.6129460334777832,-0.440936803817749,-0.12251780182123184,0.25749075412750244,-0.21793797612190247,-0.31565356254577637,-1.0452193021774292,0.48470351099967957,1.489746332168579,0.34717267751693726,-0.11593799293041229,0.5712113380432129,0.37145087122917175,-0.1405247449874878,0.10602741688489914,0.44691920280456543,0.2407248467206955,0.1857607066631317,-0.4698955714702606,-0.6073989272117615,0.003017023205757141,-0.692069411277771,-0.056892529129981995,0.2016339898109436,-0.6986490488052368,-0.4357801079750061,-0.3368676006793976,-0.21542751789093018,0.16499149799346924,-0.49468180537223816,0.7049293518066406,0.35484278202056885,-0.12084715068340302,-2.1006436347961426,0.17676638066768646,1.0268604755401611,-0.1937757432460785,-0.3107340335845947,-0.12163938581943512,0.4608701467514038,-0.5104370713233948,0.41666844487190247,-0.25553765892982483,1.501641869544983,0.391608864068985,-0.5072856545448303,-0.3386199176311493,0.35516029596328735,0.4765162467956543,-0.1931939572095871,-0.04903487116098404,-0.11199391633272171,-0.31363174319267273,-0.16184554994106293,1.0071266889572144,1.2638416290283203,1.3507024049758911,0.7613588571548462,0.4123046398162842,0.2764201760292053,-0.6620365977287292,-0.957791805267334,0.1179533302783966,0.05718009173870087,-0.5120300054550171,0.683925211429596,-0.38944295048713684,-0.40000054240226746,-0.1454511433839798,0.30291903018951416,-0.36079010367393494,-0.48647207021713257,0.13034778833389282,1.8149853944778442,0.11981132626533508,-0.16857168078422546,0.27804651856422424,-0.248652383685112,-0.22382158041000366,-0.02025716006755829,0.23994572460651398,-0.38804712891578674,0.15800036489963531,-0.7771037817001343,0.3905825614929199,-0.7868342995643616,-0.009819000959396362,-0.2602401375770569,0.5894878506660461,0.41537952423095703,0.20397962629795074,0.858824610710144,0.4924372136592865,-0.09800249338150024,0.33428242802619934,-0.15497006475925446,-0.18699677288532257,-0.10839053988456726]}},true]},{"type":"Workflow","content":[{"workflow":{"name":"RAG","version":"v0.1","steps":[{"name":"Initialize","body":[{"type":"composite","value":[{"type":"registeroperation","value":{"register":"$FILE_PIECES","value":{"name":"process_embeddings_in_job_scope_with_metadata","args":[]}}},{"type":"registeroperation","value":{"register":"$LLM_INPUT","value":{"name":"generate_json_map","args":[{"type":"string","value":"question"},{"type":"register","value":"$INPUT"},{"type":"string","value":"documents"},{"type":"register","value":"$FILE_PIECES"}]}}},{"type":"registeroperation","value":{"register":"$LLM_RESPONSE","value":{"name":"baml_answer_with_citations","args":[{"type":"register","value":"$LLM_INPUT"}]}}},{"type":"registeroperation","value":{"register":"$JINJA","value":"# Introduction\\n{%- for sentence in answer.brief_introduction.sentences %}\\n{{ sentence }}\\n{%- endfor %}\\n\\n# Body\\n{%- for section in answer.extensive_body %}\\n## Section {{ loop.index }}\\n{%- for sentence in section.sentences %}\\n{{ sentence }}\\n{%- endfor %}\\n{%- endfor %}\\n\\n# Conclusion\\n{%- for section in answer.conclusion %}\\n{{ section.sentences[0] }}\\n{%- endfor %}\\n\\n# Citations\\n{%- for citation in relevantSentencesFromText %}\\n[{{ citation.citation_id }}]: {{ citation.relevantSentenceFromDocument }}\\n{%- endfor %}"}},{"type":"registeroperation","value":{"register":"$RESULT","value":{"name":"shinkai__json-to-md","args":[{"type":"string","value":"message"},{"type":"register","value":"$LLM_RESPONSE"},{"type":"string","value":"template"},{"type":"register","value":"$JINJA"}]}}}]}]}],"raw":"\n            workflow RAG v0.1 {\n                step Initialize {\n                    $FILE_PIECES = call process_embeddings_in_job_scope_with_metadata()\n                    \n                    $LLM_INPUT = call generate_json_map(\"question\", $INPUT, \"documents\", $FILE_PIECES)\n                    \n                    $LLM_RESPONSE = call baml_answer_with_citations($LLM_INPUT)\n                    \n                    $JINJA = \"# Introduction\\n{%- for sentence in answer.brief_introduction.sentences %}\\n{{ sentence }}\\n{%- endfor %}\\n\\n# Body\\n{%- for section in answer.extensive_body %}\\n## Section {{ loop.index }}\\n{%- for sentence in section.sentences %}\\n{{ sentence }}\\n{%- endfor %}\\n{%- endfor %}\\n\\n# Conclusion\\n{%- for section in answer.conclusion %}\\n{{ section.sentences[0] }}\\n{%- endfor %}\\n\\n# Citations\\n{%- for citation in relevantSentencesFromText %}\\n[{{ citation.citation_id }}]: {{ citation.relevantSentenceFromDocument }}\\n{%- endfor %}\"\n                    \n                    $RESULT = call shinkai__json-to-md(\"message\",$LLM_RESPONSE,\"template\",$JINJA)\n                }\n            } @@official.shinkai\n        ","description":"Generates an answer to a question with citations from the provided content using RAG workflow.","author":"@@official.shinkai","sticky":false},"embedding":{"id":"","vector":[0.3264797627925873,0.6052402257919312,-0.08838757872581482,0.2322770357131958,-0.5915845632553101,-0.04368985444307327,-1.2123489379882812,0.0267048180103302,0.46233847737312317,-0.028976384550333023,-0.23306003212928772,0.8775257468223572,0.34762415289878845,0.17380496859550476,0.2553696632385254,0.12933200597763062,-0.06717750430107117,-0.6935021877288818,-1.494844675064087,-0.011394456028938293,0.4565299153327942,0.4279453158378601,0.15568602085113525,-0.029051296412944794,-0.27602824568748474,0.33154064416885376,0.2512126863002777,-0.10763468593358994,-1.2480343580245972,-1.8030340671539307,0.3832242488861084,0.37260785698890686,-0.4172326922416687,-0.4720008671283722,-0.13194310665130615,-0.43950921297073364,0.001856203773058951,0.14273804426193237,-0.6191220879554749,0.24850581586360931,0.06531619280576706,0.29962030053138733,0.1588892936706543,0.16487258672714233,0.4343034625053406,-0.581734299659729,0.406770259141922,-0.45346367359161377,0.3900458812713623,0.2095755934715271,-0.6586560606956482,-0.6087415218353271,0.3691110908985138,0.4626093804836273,-0.44294941425323486,0.28811395168304443,0.4716208577156067,0.004851225763559341,0.49684518575668335,-0.038454048335552216,0.3979896903038025,0.1805819869041443,-4.4982805252075195,0.5074162483215332,0.08056776970624924,0.06798148155212402,0.37245193123817444,-0.1326691210269928,-0.02521642856299877,0.030897080898284912,-0.06098252534866333,-0.2569488286972046,-0.21478590369224548,-0.05605834722518921,-0.02764083445072174,-0.3553803265094757,-0.3064717650413513,0.07025354355573654,0.3963940143585205,-0.6175645589828491,-0.07276612520217896,0.592605710029602,0.11708809435367584,0.0417887307703495,-0.7172545194625854,0.4049193561077118,-0.36222130060195923,-0.3306307792663574,0.23741118609905243,0.47863325476646423,-0.22743389010429382,-0.09804314374923706,0.38853827118873596,-0.2796548306941986,-0.498765766620636,0.25627416372299194,0.07142673432826996,0.29684144258499146,0.3757385015487671,3.215141773223877,0.20312011241912842,-0.6196138262748718,0.7082496881484985,-0.761162281036377,0.2293570339679718,-0.587596595287323,0.22240744531154633,-0.18588854372501373,0.3123873472213745,0.5502053499221802,0.19838498532772064,-0.36524301767349243,-0.27119389176368713,0.4646731913089752,0.5151158571243286,0.04511918127536774,-0.4748515486717224,0.03356776013970375,-0.1869903951883316,0.8342957496643066,-0.26072150468826294,-0.011738184839487076,-0.38192373514175415,-0.2593814730644226,0.3734847903251648,0.4604232907295227,0.03184940293431282,0.2125272899866104,0.29142552614212036,0.263128399848938,0.2948923707008362,-0.36832764744758606,-1.030495047569275,-0.11100795865058899,-0.2726568579673767,0.23690947890281677,0.9641664028167725,-0.6825208067893982,0.2355262041091919,-0.7954396605491638,-0.06666058301925659,-1.1485283374786377,0.7713145613670349,0.23018789291381836,0.5262817144393921,-0.10779017210006714,-0.856001079082489,0.2630016505718231,-0.6368698477745056,0.09511351585388184,-0.35036686062812805,0.22286269068717957,-0.3424697816371918,0.0911654680967331,0.8242197632789612,-0.1238294392824173,-0.5630863308906555,0.0007122233510017395,-0.5012823939323425,0.2977387309074402,-0.3769890069961548,-0.3523453176021576,0.5293335914611816,0.13736145198345184,0.43596524000167847,-0.16486014425754547,0.22288919985294342,-0.015766281634569168,0.4096457064151764,-0.44128188490867615,0.25367671251296997,0.05341789498925209,0.1546356976032257,0.5948237776756287,-0.2969697415828705,-0.010816741734743118,0.018274106085300446,0.135623037815094,-0.07625912129878998,-0.3131198287010193,0.7826070785522461,0.35047614574432373,-0.36469995975494385,-0.17949041724205017,-0.08755603432655334,0.35411500930786133,0.5309076309204102,0.15411114692687988,0.7076097726821899,0.8691877126693726,-0.4564625322818756,1.3150970935821533,-0.5303483009338379,0.06065240502357483,0.26967838406562805,-0.12217947095632553,0.1004878580570221,0.15800072252750397,0.9680444598197937,-0.1979808658361435,0.4702289402484894,0.28666478395462036,0.38202667236328125,-0.16305077075958252,0.24903321266174316,-0.43068206310272217,-0.1978066861629486,0.2972709536552429,-0.41837453842163086,-0.7112369537353516,-0.1107989251613617,-0.6839892864227295,0.696219801902771,0.5221155881881714,0.2960105538368225,0.3499150276184082,-0.0794273316860199,-0.212468683719635,0.45576828718185425,0.4317437708377838,-0.32402288913726807,0.1452396959066391,-0.011959865689277649,-0.5864479541778564,-0.42766591906547546,0.6707659363746643,-0.13050594925880432,-0.1180577278137207,-0.1653956174850464,-0.33208268880844116,0.2788654565811157,0.8057324290275574,0.5520050525665283,1.2830705642700195,0.7093963623046875,0.2840104401111603,-0.4082257151603699,0.27542799711227417,0.4873925745487213,-0.2522101104259491,0.11907622218132019,0.028363190591335297,0.20635758340358734,-0.18819499015808105,0.2246723771095276,-0.6655619144439697,-0.10446103662252426,-0.23150765895843506,0.09669044613838196,1.7576770782470703,0.14994856715202332,-0.32084840536117554,0.7115395665168762,0.36207491159439087,0.02094719558954239,0.24793824553489685,-1.9055274724960327,-0.23836877942085266,-0.46155938506126404,0.8016499280929565,0.17974653840065002,-0.37561920285224915,0.6458562016487122,0.06742709130048752,0.020449098199605942,-0.3048936128616333,-0.8961384296417236,-0.7088284492492676,-0.14746157824993134,-0.11284986883401871,-0.6528003215789795,0.7336992025375366,-0.5682182908058167,0.20981866121292114,-0.05374544858932495,0.1252681165933609,0.2656119167804718,0.20380675792694092,-0.6086755990982056,-0.523114025592804,0.4418862462043762,-0.2729118764400482,-0.36117568612098694,0.06014471501111984,-0.30588769912719727,-0.15482869744300842,-0.6516886353492737,-0.25265225768089294,-0.11693356186151505,-0.04211577773094177,-0.189766526222229,-0.6128356456756592,-0.6885031461715698,0.377397358417511,1.935836911201477,0.19929981231689453,0.03032916784286499,0.1991160809993744,0.38732442259788513,-0.21676932275295258,0.3985392153263092,0.15045830607414246,-0.3452260196208954,-0.21982476115226746,-0.7910107970237732,0.06679975241422653,0.26968473196029663,-0.3831362724304199,-0.0238817036151886,0.4238829016685486,-0.35494935512542725,-0.1918790191411972,0.04105297103524208,0.3055642247200012,0.5485197901725769,-0.4098147749900818,0.04434345290064812,0.2721412181854248,-0.25551414489746094,-2.419203519821167,0.050775185227394104,0.5076777338981628,-0.12216608226299286,-0.1892971396446228,-0.2650960683822632,0.5755186676979065,0.016198452562093735,0.12278316915035248,-0.60592120885849,1.5143930912017822,0.7156854271888733,-0.1529489904642105,-0.41207754611968994,-0.06407853215932846,0.8137408494949341,-0.03840029612183571,0.46164533495903015,-0.1498732566833496,-0.25452086329460144,-0.47752946615219116,0.658669650554657,1.339207649230957,0.48996442556381226,0.6034058928489685,0.05065757408738136,0.16774341464042664,-0.778769314289093,-1.26719331741333,0.21318112313747406,0.162215456366539,-0.49841317534446716,0.8600791692733765,-0.41512513160705566,-0.6178964972496033,-0.0024829544126987457,0.7752062678337097,0.02650533616542816,0.24390414357185364,0.0432179756462574,1.8687701225280762,-0.347438246011734,-0.42003199458122253,-0.14850477874279022,-0.1337883472442627,-0.4191751182079315,0.32700586318969727,0.06828166544437408,-0.6720443367958069,0.3062012791633606,-0.2570558488368988,0.28694143891334534,-0.6853766441345215,-0.03619381785392761,-0.3193512260913849,0.3563652038574219,0.07374319434165955,0.19840386509895325,0.6513432264328003,0.5856884717941284,-0.11430320143699646,0.17541953921318054,-0.2967044711112976,-0.5660766959190369,0.15609338879585266]}},true]}]"###;
pub static WORKFLOWS_JSON: &str = r###"[{"type":"Workflow","content":[{"workflow":{"name":"Extensive_summary","version":"v0.1","steps":[{"name":"Initialize","body":[{"type":"composite","value":[{"type":"registeroperation","value":{"register":"$PROMPT","value":"Summarize this: "}},{"type":"registeroperation","value":{"register":"$EMBEDDINGS","value":{"name":"process_embeddings_in_job_scope","args":[]}}}]}]},{"name":"Summarize","body":[{"type":"registeroperation","value":{"register":"$RESULT","value":{"name":"multi_inference","args":[{"type":"register","value":"$PROMPT"},{"type":"register","value":"$EMBEDDINGS"}]}}}]}],"raw":"\n            workflow Extensive_summary v0.1 {\n                step Initialize {\n                    $PROMPT = \"Summarize this: \"\n                    $EMBEDDINGS = call process_embeddings_in_job_scope()\n                }\n                step Summarize {\n                    $RESULT = call multi_inference($PROMPT, $EMBEDDINGS)\n                }\n            } @@official.shinkai\n        ","description":"Reviews in depth all the content to generate a summary.","author":"@@official.shinkai","sticky":false},"embedding":{"id":"","vector":[0.6820248961448669,0.5723804831504822,0.056784410029649734,-0.029523666948080063,-0.2254689335823059,-0.053013481199741364,-0.6708416938781738,-0.2624345123767853,-0.033756330609321594,0.4013897180557251,-0.16321982443332672,0.971656858921051,0.2718249261379242,0.07108756899833679,0.2820807695388794,0.14116838574409485,-0.11496889591217041,-0.49301284551620483,-1.0789883136749268,-0.043452829122543335,0.19382520020008087,0.5948700308799744,0.6591302156448364,0.16274362802505493,-0.030279342085123062,-0.1913491189479828,-0.3163045048713684,-0.2898331880569458,-0.7694717645645142,-2.4501161575317383,0.5279894471168518,0.0053562745451927185,-0.5002804398536682,-0.5608552694320679,0.028381161391735077,-0.6834791302680969,0.328404039144516,0.2872193455696106,-0.27112722396850586,-0.2420305460691452,-0.20994114875793457,0.23660853505134583,-0.35357770323753357,0.590043306350708,0.27437782287597656,0.06486925482749939,-0.15818193554878235,-0.2542445659637451,0.3756386339664459,0.38245582580566406,-0.45134201645851135,-0.26646173000335693,-0.21188713610172272,0.5074135065078735,-0.45056354999542236,0.42795759439468384,-0.14764094352722168,-0.299643874168396,0.24885445833206177,0.021038610488176346,0.29774922132492065,0.527859091758728,-4.216637134552002,0.35374659299850464,0.19555260241031647,0.3751485049724579,0.17744454741477966,-0.2610761225223541,-0.172037273645401,0.032772570848464966,0.05567239597439766,0.19824181497097015,-0.13289085030555725,-0.1100323274731636,-0.23126265406608582,-0.34616896510124207,0.3950774073600769,0.35234352946281433,0.1308232843875885,-0.6239751577377319,-0.7391460537910461,0.4362350106239319,-0.0347885936498642,0.09445835649967194,-0.2117754966020584,0.7171225547790527,-0.3040316104888916,-0.3600367605686188,0.37041613459587097,-0.06581398844718933,-0.006318345665931702,-0.21981696784496307,-0.002286979928612709,0.2790469229221344,-0.7975400686264038,0.10219541937112808,0.15441451966762543,0.11658502370119095,0.4612636864185333,3.6136317253112793,0.6766623854637146,-0.28591224551200867,0.7045385241508484,-0.4960375726222992,0.1050494909286499,-0.5604535937309265,-0.25389742851257324,-0.2956107258796692,0.40285223722457886,-0.111656554043293,0.015156731009483337,-0.5351597666740417,-0.030287399888038635,0.3177969753742218,0.21704047918319702,0.7171976566314697,-0.46601396799087524,0.3439251184463501,-0.061566051095724106,0.20522497594356537,-0.6280752420425415,0.130172997713089,0.051850613206624985,0.21620029211044312,-0.2943073809146881,0.1809474229812622,-0.23445376753807068,0.2775576710700989,0.2914619445800781,0.0578656867146492,0.10241352021694183,-0.15168319642543793,-0.7568095326423645,0.092719167470932,-0.0777229368686676,-0.15893718600273132,0.5966013073921204,-0.7341698408126831,0.25946319103240967,-0.9252210259437561,0.09058776497840881,-1.5351767539978027,0.7115793824195862,0.29241278767585754,0.7798487544059753,-0.08018416166305542,-0.13354992866516113,-0.08928925544023514,-0.4238916337490082,-0.5697543025016785,0.06765686720609665,0.77348792552948,-0.04202955216169357,0.06487800180912018,0.5874587893486023,-0.11936471611261368,-0.25156763195991516,0.19140180945396423,-0.5563774108886719,0.31181517243385315,-0.32280847430229187,-0.15203385055065155,0.6281672716140747,0.6141714453697205,0.5077856183052063,-0.20541121065616608,0.334749698638916,-0.22992375493049622,0.3473362326622009,0.13209888339042664,-0.046164438128471375,-0.4251396954059601,0.33730384707450867,0.8212467432022095,0.177277609705925,-0.1610117256641388,-0.07467097789049149,0.2908981442451477,0.2191067337989807,-0.5679166316986084,0.7439255714416504,0.5261525511741638,-0.11653833091259003,-0.3659759759902954,-0.023860540241003036,-0.26393836736679077,0.42201778292655945,-0.21162325143814087,0.6553518176078796,0.7129044532775879,-0.8967499136924744,1.4437609910964966,-0.7139504551887512,-0.4562397301197052,0.1866864711046219,-0.1461351215839386,-0.5919792056083679,-0.022950291633605957,0.10381539165973663,0.28671005368232727,-0.5119964480400085,0.06818243861198425,-0.34842413663864136,-0.2360081672668457,-0.20727667212486267,-0.666267454624176,-0.2698496878147125,0.14760757982730865,-0.1733710914850235,-0.7490845322608948,0.17996001243591309,-0.1494026631116867,0.6294229030609131,0.6854228973388672,0.45075780153274536,0.16544346511363983,0.15525199472904205,0.40028688311576843,0.6559727787971497,0.5462879538536072,0.6049190759658813,-0.16969510912895203,-0.5258905291557312,-0.7370105385780334,-0.5058722496032715,0.05097363144159317,-0.4502354860305786,-0.16756923496723175,-0.3616001605987549,-0.07482671737670898,0.5364893674850464,0.3961637616157532,0.6380713582038879,0.7769057154655457,0.45226916670799255,0.12783251702785492,-0.06475261598825455,0.5124138593673706,0.2543259561061859,-0.3266713619232178,0.6652782559394836,-0.10381640493869781,-0.2858583927154541,0.369432270526886,0.4281133711338043,-0.397693008184433,-0.4147809147834778,-0.007397249341011047,-0.16696804761886597,1.8266067504882812,0.09511159360408783,-0.33791670203208923,0.20951442420482635,0.5353755950927734,0.4132263660430908,0.07172563672065735,-1.3672807216644287,0.033725690096616745,-0.6914818286895752,0.4152260720729828,-0.29042062163352966,0.2820392847061157,-0.12484639883041382,0.12444232404232025,-0.2538592219352722,-0.1376664787530899,-0.376803457736969,-0.21342863142490387,-0.3275066018104553,-0.1573990434408188,0.07955310493707657,0.7591940760612488,0.06325787305831909,-0.1243286207318306,-0.06205055117607117,0.27926522493362427,0.1881060153245926,-0.07187489420175552,-0.43998342752456665,-0.04985599219799042,0.35954052209854126,0.07155530899763107,0.37024304270744324,0.25004273653030396,-0.5525103211402893,-0.2558727264404297,-0.36321941018104553,0.04473167657852173,-0.09463290125131607,-0.01605386659502983,-0.21422991156578064,-0.40423282980918884,-0.07233521342277527,0.24171797931194305,1.5734977722167969,0.2532348036766052,0.3514263331890106,0.5783570408821106,0.38809657096862793,0.18779775500297546,-0.7362217903137207,0.018929127603769302,-0.2433643937110901,-0.1767692118883133,-0.6034640073776245,-0.2618042230606079,0.23901714384555817,0.25006982684135437,-0.3671899735927582,0.56818026304245,-0.45649564266204834,-0.5177562832832336,0.21355649828910828,0.04084805026650429,0.36265265941619873,-0.4912548065185547,0.3579895794391632,-0.06822404265403748,0.23526312410831451,-2.4479732513427734,-0.409572571516037,0.33847421407699585,0.39877307415008545,-0.31740933656692505,-0.13011762499809265,1.0355134010314941,-0.2030523419380188,0.004002278670668602,-0.17361848056316376,1.0097349882125854,0.3712850511074066,0.04738866910338402,-0.38382434844970703,-0.22995835542678833,0.10955353826284409,-0.5831428170204163,0.5505454540252686,-0.251912921667099,-0.6052247285842896,-0.11847558617591858,0.39012327790260315,1.722125768661499,0.4369223117828369,0.4068147540092468,-0.08888967335224152,0.16951988637447357,-0.7578551769256592,-1.5347665548324585,-0.09822624921798706,-0.1749330759048462,-0.40222880244255066,0.40935447812080383,-0.014797728508710861,-0.25942203402519226,0.7363397479057312,0.8023666143417358,0.1866847723722458,1.0114266872406006,-0.37116944789886475,1.44536292552948,-0.37696170806884766,-0.06581003218889236,0.011476762592792511,0.43547624349594116,0.33689627051353455,0.4570700526237488,-0.09152284264564514,-0.7278273105621338,-0.19184312224388123,-0.024527274072170258,0.5096248984336853,-0.4112659990787506,0.585030198097229,0.6007319092750549,0.13742738962173462,-0.0392843633890152,0.18517468869686127,0.4498704671859741,0.053321029990911484,0.055953219532966614,-0.3754947781562805,-0.2632603943347931,-0.8821566700935364,-0.5415434241294861]}},true]},{"type":"Workflow","content":[{"workflow":{"name":"Hyde_inference","version":"v0.1","steps":[{"name":"Initialize","body":[{"type":"composite","value":[{"type":"registeroperation","value":{"register":"$PROMPT","value":"write a passage to answer the question: "}},{"type":"registeroperation","value":{"register":"$HYDE_PROMPT","value":{"name":"concat","args":[{"type":"register","value":"$PROMPT"},{"type":"register","value":"$INPUT"}]}}},{"type":"registeroperation","value":{"register":"$HYDE_PASSAGE","value":{"name":"inference_no_ws","args":[{"type":"register","value":"$HYDE_PROMPT"}]}}},{"type":"registeroperation","value":{"register":"$HYDE_INPUT","value":{"name":"concat","args":[{"type":"register","value":"$INPUT"},{"type":"string","value":". "},{"type":"register","value":"$HYDE_PASSAGE"}]}}},{"type":"registeroperation","value":{"register":"$EMBEDDINGS","value":{"name":"search_embeddings_in_job_scope","args":[{"type":"register","value":"$HYDE_INPUT"}]}}}]}]},{"name":"Summarize","body":[{"type":"composite","value":[{"type":"registeroperation","value":{"register":"$CONNECTOR","value":"\\nLeverage the following information to answer the previous query: --- start ---"}},{"type":"registeroperation","value":{"register":"$NEW_INPUT","value":{"name":"concat","args":[{"type":"register","value":"$INPUT"},{"type":"register","value":"$CONNECTOR"},{"type":"register","value":"$EMBEDDINGS"}]}}},{"type":"registeroperation","value":{"register":"$RESULT","value":{"name":"inference","args":[{"type":"register","value":"$NEW_INPUT"}]}}}]}]}],"raw":"\n            workflow Hyde_inference v0.1 {\n                step Initialize {\n                    $PROMPT = \"write a passage to answer the question: \"\n                    $HYDE_PROMPT = call concat($PROMPT, $INPUT)\n                    $HYDE_PASSAGE = call inference_no_ws($HYDE_PROMPT)\n                    $HYDE_INPUT = call concat($INPUT, \". \", $HYDE_PASSAGE )\n                    $EMBEDDINGS = call search_embeddings_in_job_scope($HYDE_INPUT)\n                }\n                step Summarize {\n                    $CONNECTOR = \"\\nLeverage the following information to answer the previous query: --- start ---\"\n                    $NEW_INPUT = call concat($INPUT, $CONNECTOR, $EMBEDDINGS) \n                    $RESULT = call inference($NEW_INPUT)\n                }\n            } @@official.shinkai\n        ","description":"Generates a passage to answer a question and uses embeddings to refine the answer.","author":"@@official.shinkai","sticky":false},"embedding":{"id":"","vector":[-0.04964948445558548,0.07351528108119965,-0.0037448257207870483,-0.5989986658096313,-0.2695397734642029,0.0556429848074913,-0.8189688920974731,0.17371350526809692,-0.042529553174972534,-0.278947651386261,-0.1592383086681366,0.7632817625999451,-0.15512093901634216,0.5815573930740356,0.40833333134651184,0.08403884619474411,0.10889555513858795,-0.09859824180603027,-1.4305481910705566,-0.36282309889793396,0.26563403010368347,0.5795038938522339,0.6247695684432983,0.09672331809997559,0.2193397581577301,-0.3369952440261841,0.45206624269485474,-0.20352067053318024,-0.8568096160888672,-1.5192517042160034,0.45000338554382324,0.1857410967350006,-0.5474480986595154,-0.6226603984832764,-0.3259250521659851,-0.8049982786178589,0.41149431467056274,-0.33869048953056335,-0.40478962659835815,0.14186139404773712,0.08049512654542923,0.12524786591529846,0.05503413826227188,0.5369344353675842,0.22099512815475464,-0.22166168689727783,0.49372294545173645,0.14834408462047577,0.7515535950660706,0.23170407116413116,-0.38584038615226746,-0.6664334535598755,0.08026009798049927,0.05644957721233368,-0.47618070244789124,-0.07221367955207825,-0.013390932232141495,-0.7227036356925964,0.2766876816749573,-0.2050083577632904,0.0018085697665810585,0.36839884519577026,-4.047801494598389,0.25997495651245117,0.6095144748687744,0.29139724373817444,0.1967528611421585,0.33130836486816406,0.10284334421157837,0.6389473080635071,0.3290032148361206,0.469316303730011,-0.6486641764640808,0.9727193713188171,0.1883121132850647,-0.33047881722450256,-0.36619096994400024,0.22055767476558685,0.3932532072067261,-0.5142701864242554,-0.008600234985351562,0.1599426567554474,-0.09545424580574036,0.23433077335357666,-0.042303428053855896,0.7357178926467896,-0.32235464453697205,0.08163000643253326,0.14104235172271729,-0.11884527653455734,-0.03371256962418556,0.0557616725564003,0.3496687710285187,-0.03216787800192833,-0.003476671874523163,0.3798062205314636,0.03774901106953621,0.20039451122283936,-0.3984847366809845,3.36946439743042,-0.13239504396915436,0.001673419028520584,0.7380388379096985,-0.30677103996276855,0.9782622456550598,-0.19148962199687958,-0.3291283845901489,-0.27219173312187195,0.11630738526582718,-0.3731819987297058,0.2829224765300751,-0.5195115208625793,-0.707719087600708,0.13076543807983398,0.09487534314393997,0.3715026080608368,-0.21381931006908417,0.06631460785865784,0.1631127893924713,0.6596425771713257,-0.34905654191970825,0.4622417092323303,-0.2369920015335083,-0.4202103316783905,-0.5958117246627808,-0.0054769366979599,0.05269158259034157,0.3168359696865082,-0.42596322298049927,-0.2948320209980011,0.19625362753868103,0.3843995928764343,-0.7386986017227173,0.29027774930000305,0.38638198375701904,0.398516982793808,0.5393836498260498,-0.7760148644447327,0.026768285781145096,-0.6783398985862732,0.3489813208580017,-1.9833325147628784,0.42915868759155273,-0.3807029724121094,0.7297704219818115,-0.3749578893184662,-0.988932728767395,-0.049560628831386566,-0.748236894607544,-0.39161738753318787,-0.07422567903995514,0.7568775415420532,-0.42796590924263,-0.6895531415939331,0.7455142736434937,0.3727438449859619,-0.302215039730072,-0.2940479516983032,-0.39270395040512085,0.48044177889823914,-0.45199188590049744,0.012708820402622223,-0.014463722705841064,0.38177770376205444,0.41518479585647583,-0.26775816082954407,0.0609671026468277,0.259851336479187,0.5660082101821899,0.28002557158470154,0.2567088007926941,0.08408413827419281,-0.17901833355426788,0.6893192529678345,-0.18076415359973907,-0.1638849675655365,0.7592079639434814,-0.2850896716117859,0.09555481374263763,-0.34255003929138184,0.21607792377471924,0.6083880066871643,-0.27518394589424133,-0.2888985574245453,0.4869835376739502,0.24507123231887817,-0.04523368924856186,0.08955748379230499,0.8814894556999207,0.7514408826828003,-0.7933105826377869,1.4745051860809326,-0.8296284675598145,0.20127254724502563,-0.17663174867630005,0.10280756652355194,0.7590713500976562,0.6627715826034546,0.011114057153463364,-0.21741513907909393,-0.2958572506904602,-0.07200832664966583,-0.028994381427764893,-0.11766113340854645,-0.29194989800453186,-0.8990501165390015,0.22843225300312042,0.3628116250038147,-0.7341636419296265,-0.3731664717197418,-0.16071830689907074,-0.0289015993475914,0.7402246594429016,0.38305380940437317,0.8563412427902222,0.43994849920272827,0.30292415618896484,-0.22889143228530884,0.16537168622016907,0.7458362579345703,0.012104399502277374,-0.15416470170021057,-0.14556102454662323,-0.748606264591217,-0.5879684686660767,0.3174847364425659,-0.35950881242752075,-0.18004687130451202,-0.31736502051353455,-0.17857733368873596,0.23575669527053833,0.9159373044967651,0.2646183967590332,1.1622544527053833,0.6009469628334045,-0.020364172756671906,0.005769722163677216,0.3249523639678955,0.10982750356197357,-0.18247875571250916,-0.018897704780101776,-0.3283432722091675,0.06723657250404358,-0.18632438778877258,0.016186058521270752,-0.299119770526886,0.27416902780532837,-0.4262268543243408,-0.17139290273189545,1.6794452667236328,0.958503246307373,0.46273133158683777,0.3776611387729645,0.4485767185688019,0.4364531934261322,0.14672908186912537,-1.850408911705017,0.0067354487255215645,-0.7456330060958862,0.5802070498466492,0.3341884911060333,-0.7816597819328308,0.8321707248687744,-0.13638745248317719,-0.02185065858066082,-0.4651019871234894,-0.46033725142478943,-0.7211554050445557,-0.36014968156814575,-0.14086481928825378,-0.5944161415100098,0.8056583404541016,-0.7071620225906372,0.3785657584667206,-0.332245409488678,-0.09814120084047318,0.4233565926551819,0.015407413244247437,-0.33447521924972534,-0.4071231186389923,-0.067552350461483,-0.013831926509737968,0.16377918422222137,0.4718702435493469,-0.27083900570869446,-0.020545989274978638,-0.7419271469116211,-0.41673678159713745,-0.10136746615171432,0.2697226405143738,-0.28535905480384827,-0.3748951554298401,-0.7390844821929932,0.034545667469501495,1.644720435142517,-0.009804271161556244,-0.3737269937992096,0.5042737722396851,0.20176424086093903,-0.45157724618911743,-0.029246389865875244,-0.25737810134887695,-0.16420505940914154,0.39507946372032166,-0.6092503666877747,-0.547132134437561,0.49879688024520874,0.050793204456567764,-0.42933282256126404,-0.6348257064819336,-0.5210633873939514,-0.01414722204208374,0.241664320230484,0.07189908623695374,0.6878603100776672,-0.44729337096214294,0.6146893501281738,0.3114408254623413,0.09885749220848083,-2.39998459815979,0.22510097920894623,0.08821532130241394,0.02281942591071129,-0.16851471364498138,-0.39948421716690063,0.4781944751739502,-0.1106119155883789,0.37788909673690796,-0.5341840386390686,1.6657711267471313,0.23619230091571808,-0.16936853528022766,-0.34403157234191895,-0.05048051103949547,0.5156921148300171,-0.5097588300704956,-0.1076057031750679,0.16615211963653564,-0.41826316714286804,-0.09777717292308807,0.4317220151424408,1.4926064014434814,0.4437429904937744,0.6409068703651428,-0.2857368588447571,0.4252455234527588,-0.4507920742034912,-1.395687222480774,0.32343316078186035,-0.14300259947776794,0.17345699667930603,0.6882900595664978,-0.031068190932273865,-0.014234764501452446,0.2588723599910736,0.6380057334899902,-0.10916788876056671,0.21145275235176086,0.41304823756217957,1.875705361366272,0.30104920268058777,-0.14842073619365692,-0.4808446764945984,-0.3084228038787842,-0.2934291660785675,0.12193095684051514,0.18131327629089355,-0.632544219493866,0.30189579725265503,0.13330793380737305,0.1023193746805191,-0.14311614632606506,0.4220004975795746,0.20342287421226501,0.7711853981018066,0.04235168173909187,-0.061884328722953796,1.1321145296096802,-0.16180944442749023,0.008948512375354767,-0.0014485716819763184,-0.1739363670349121,-0.3506462275981903,-0.4292738437652588]}},true]},{"type":"Workflow","content":[{"workflow":{"name":"baml_answer_with_citations","version":"v0.1","steps":[{"name":"Initialize","body":[{"type":"composite","value":[{"type":"registeroperation","value":{"register":"$DSL","value":"class Citation {\n            citation_id int\n            document_reference string @description(#\\\"The name of the document and the page number that supports the answer e.g., FILENAME: Page [PAGE NUMBER]. This is a reference. You must mention it NO MATTER WHAT.\\\"#)\n            relevantTextFromDocument string @alias(\\\"relevantSentenceFromDocument\\\") @description(#\\\"The relevant text from the document that supports the answer. This is part of the citation. You must quote it EXACTLY as it appears in the document with any special characters it contains. You may cite a part of the sentence. The text should be contiguous and not broken up. You may NOT summarize or skip sentences. If you need to skip a sentence, start a new citation instead.\\\"#)\n        }\n\n        class Answer {\n            answersInText Citation[] @alias(\\\"relevantSentencesFromText\\\")\n            answer AnswerWithCitations @description(#\\\"An answer to the user's question that MUST cite sources from the relevantSentencesFromText. Like [0]. If multiple citations are needed, write them like [0][1][2].\\\"#)\n        }\n\n        class AnswerWithCitations {\n            brief_introduction Paragraph @description(#\\\"3-4 long sentences. Must use the citations in the text.\\\"#)\n            extensive_body Paragraph[] @description(#\\\"At least 3-6 long sentences. The more the better. Must use the citations in the text.\\\"#)\n            conclusion Paragraph[] @description(#\\\"1-3 long sentences. Must use the citations in the text.\\\"#)\n        }\n\n        class Paragraph {\n            sentences string[]\n        }\n\n        class Document {\n            file string\n            text string\n            reference string\n        }\n        class Context {\n            documents Document[]\n            question string\n        }\n\n        function AnswerQuestion(context: Context) -> Answer {\n            client ShinkaiProvider\n\n            prompt #\\\"\n                Out of the given content, do your best to answer the question.\n\n                CONTEXT:\n                {% for document in context.documents %}\n                ----\n                DOCUMENT NAME: {{  document.file }}\n                PARTIAL TEXT: {{ document.text }}\n                DOCUMENT REFERENCE: {{ document.reference }}\n                ---\n                {% endfor %}\n                \n                {{ ctx.output_format }}\n\n                QUESTION: {{ context.question }}. Citing the references no matter what e.g., [0]. If multiple citations are needed, write them like [0][1][2].\n\n                ANSWER:\n                {{ _.role(\\\"user\\\") }}\n            \\\"#\n        }"}},{"type":"registeroperation","value":{"register":"$PARAM","value":"context"}},{"type":"registeroperation","value":{"register":"$FUNCTION","value":"AnswerQuestion"}},{"type":"registeroperation","value":{"register":"$RESULT","value":{"name":"baml_inference","args":[{"type":"register","value":"$INPUT"},{"type":"string","value":""},{"type":"string","value":""},{"type":"register","value":"$DSL"},{"type":"register","value":"$FUNCTION"},{"type":"register","value":"$PARAM"}]}}}]}]}],"raw":"\n            workflow baml_answer_with_citations v0.1 {\n                step Initialize {\n                    $DSL = \"class Citation {\n            citation_id int\n            document_reference string @description(#\\\"The name of the document and the page number that supports the answer e.g., FILENAME: Page [PAGE NUMBER]. This is a reference. You must mention it NO MATTER WHAT.\\\"#)\n            relevantTextFromDocument string @alias(\\\"relevantSentenceFromDocument\\\") @description(#\\\"The relevant text from the document that supports the answer. This is part of the citation. You must quote it EXACTLY as it appears in the document with any special characters it contains. You may cite a part of the sentence. The text should be contiguous and not broken up. You may NOT summarize or skip sentences. If you need to skip a sentence, start a new citation instead.\\\"#)\n        }\n\n        class Answer {\n            answersInText Citation[] @alias(\\\"relevantSentencesFromText\\\")\n            answer AnswerWithCitations @description(#\\\"An answer to the user's question that MUST cite sources from the relevantSentencesFromText. Like [0]. If multiple citations are needed, write them like [0][1][2].\\\"#)\n        }\n\n        class AnswerWithCitations {\n            brief_introduction Paragraph @description(#\\\"3-4 long sentences. Must use the citations in the text.\\\"#)\n            extensive_body Paragraph[] @description(#\\\"At least 3-6 long sentences. The more the better. Must use the citations in the text.\\\"#)\n            conclusion Paragraph[] @description(#\\\"1-3 long sentences. Must use the citations in the text.\\\"#)\n        }\n\n        class Paragraph {\n            sentences string[]\n        }\n\n        class Document {\n            file string\n            text string\n            reference string\n        }\n        class Context {\n            documents Document[]\n            question string\n        }\n\n        function AnswerQuestion(context: Context) -> Answer {\n            client ShinkaiProvider\n\n            prompt #\\\"\n                Out of the given content, do your best to answer the question.\n\n                CONTEXT:\n                {% for document in context.documents %}\n                ----\n                DOCUMENT NAME: {{  document.file }}\n                PARTIAL TEXT: {{ document.text }}\n                DOCUMENT REFERENCE: {{ document.reference }}\n                ---\n                {% endfor %}\n                \n                {{ ctx.output_format }}\n\n                QUESTION: {{ context.question }}. Citing the references no matter what e.g., [0]. If multiple citations are needed, write them like [0][1][2].\n\n                ANSWER:\n                {{ _.role(\\\"user\\\") }}\n            \\\"#\n        }\"\n                    $PARAM = \"context\"\n                    $FUNCTION = \"AnswerQuestion\"\n                    $RESULT = call baml_inference($INPUT, \"\", \"\", $DSL, $FUNCTION, $PARAM)\n                }\n            } @@official.shinkai\n        ","description":"Generates an answer to a question with citations from the provided content using BAML. The answer includes quotes from the content as citations.","author":"@@official.shinkai","sticky":false},"embedding":{"id":"","vector":[0.3797622621059418,0.055756017565727234,-0.3101310729980469,-0.1303926408290863,-0.2349807769060135,-0.3620940148830414,-1.4513840675354004,0.4004634618759155,-0.09126128256320953,-0.2862396240234375,-0.21521227061748505,0.5031366348266602,0.5290755033493042,-0.1413222849369049,0.6188375949859619,0.38532504439353943,-0.11255966126918793,-0.5313267707824707,-1.018203854560852,0.16118848323822021,0.38974928855895996,0.26705488562583923,0.7251760363578796,0.3977380394935608,-0.11609482020139694,0.06196017935872078,0.13894720375537872,-0.2236107438802719,-1.2703726291656494,-1.2511805295944214,0.48944661021232605,0.2941161096096039,-0.36227738857269287,-0.2411549985408783,-0.49036508798599243,-0.4147837460041046,0.3464353680610657,-0.19157636165618896,-0.10052890330553055,0.33582234382629395,-0.34775447845458984,0.04653438180685043,0.608782172203064,-0.3258453607559204,-0.12086259573698044,-0.3823518753051758,1.0109241008758545,-0.23640067875385284,0.7499700784683228,0.8023027181625366,-0.3843623101711273,-0.3905274569988251,0.27414560317993164,0.29860666394233704,-0.4371856153011322,0.23716586828231812,0.04210366681218147,0.3562734127044678,-0.331453800201416,0.11200998723506927,0.37262940406799316,-0.3658697307109833,-3.935379981994629,0.14438453316688538,0.6308651566505432,0.21387910842895508,0.28002044558525085,-0.16130675375461578,-0.8150539994239807,-0.4389743506908417,-0.06972597539424896,-0.5424433946609497,-0.7765288949012756,0.5558378100395203,0.3599364161491394,-0.4887274503707886,-0.0007520616054534912,0.05174863338470459,0.590337872505188,-0.384021520614624,-0.053891345858573914,0.3669104278087616,-0.2317630499601364,0.25666916370391846,-0.7620011568069458,0.30930858850479126,-0.21822401881217957,-0.643441379070282,0.44276541471481323,0.660913348197937,-0.4575757086277008,-0.2502431869506836,0.15478183329105377,0.38664811849594116,-0.08887406438589096,0.2539937496185303,-0.03916637599468231,-0.5154840350151062,0.5459664463996887,2.9898178577423096,0.2672237455844879,-0.37507301568984985,0.8107877373695374,-0.5531704425811768,0.7260451912879944,-0.15623879432678223,0.3055795431137085,0.1754366159439087,0.09581713378429413,0.44947704672813416,0.31352749466896057,-0.28868404030799866,-0.5385019779205322,0.33680713176727295,-0.21201713383197784,0.7001216411590576,-0.7345210313796997,0.1426507532596588,0.11188594251871109,0.6378754377365112,0.36010265350341797,0.19299772381782532,-0.19160330295562744,-0.1184423640370369,0.14750339090824127,0.23624475300312042,0.017083611339330673,0.2653906047344208,0.2514684498310089,0.19559024274349213,0.5418351888656616,0.1569286286830902,-0.7294088006019592,0.328125923871994,0.02290940470993519,0.16350258886814117,1.043413758277893,-1.032653570175171,0.9681538343429565,-0.8715519309043884,0.21746881306171417,-1.6401642560958862,0.9072688221931458,0.3240673542022705,0.19921818375587463,-0.22009170055389404,-1.024997353553772,0.3806820213794708,-0.39549684524536133,-0.42126455903053284,-0.37500330805778503,0.12471919506788254,-0.46238279342651367,-0.11431951820850372,0.43173450231552124,-0.08136603981256485,-0.7753247022628784,-0.15560556948184967,-0.20577538013458252,0.16913741827011108,-0.24217629432678223,-0.3097689747810364,0.6912097334861755,-0.46705949306488037,-0.23456573486328125,-0.19368106126785278,-0.026194050908088684,0.29294338822364807,0.20618201792240143,0.038728564977645874,-0.313559353351593,-0.3366357088088989,0.00509969238191843,1.1993379592895508,0.15553726255893707,-0.14727765321731567,0.2659122943878174,-0.15252447128295898,0.7438075542449951,-0.1947561800479889,0.5643417239189148,0.5989380478858948,-0.6331312656402588,-0.3168948292732239,-0.23661555349826813,0.7672645449638367,0.46782436966896057,0.2681032121181488,1.418749451637268,1.2327861785888672,-0.46809977293014526,0.8014423847198486,-0.5430251359939575,-0.3643764853477478,0.15952736139297485,0.19020645320415497,0.7295116782188416,-0.0844498723745346,1.010969638824463,0.24072204530239105,0.3357287049293518,0.020911354571580887,0.2755776643753052,0.02969147264957428,-0.01337328553199768,-0.7969410419464111,-0.47564974427223206,0.5079171061515808,-0.5863653421401978,-0.7805141806602478,-0.10677085816860199,-0.8892369270324707,0.7942572236061096,0.6627474427223206,0.47531434893608093,0.3589997887611389,-0.15228474140167236,-0.10162676870822906,-0.11354662477970123,0.2639334201812744,0.07278834283351898,-0.48128312826156616,-0.8211566805839539,-0.2795396149158478,-0.7236523628234863,0.352206289768219,0.01859442889690399,-0.08775120973587036,-0.22070738673210144,-0.48127979040145874,0.36574625968933105,1.7433961629867554,0.982549786567688,1.0124894380569458,0.7370933890342712,0.4407808184623718,-0.21980562806129456,-0.13790135085582733,0.5385861396789551,-0.4323239326477051,-0.2465112805366516,-0.22517752647399902,-0.0271136611700058,0.26054584980010986,0.44240519404411316,-0.9002771377563477,0.22551384568214417,-0.5237748026847839,0.08540594577789307,1.3925650119781494,0.2770116627216339,-0.5225498676300049,0.44990918040275574,-0.1984628587961197,-0.12113264948129654,0.3022267520427704,-1.8065658807754517,-0.3099088966846466,-0.6861429214477539,0.7306676506996155,-0.30434128642082214,-0.2812166213989258,0.7118960618972778,0.04537050053477287,-0.39949703216552734,-0.9633961915969849,-0.8368886113166809,-1.018973708152771,-0.23503834009170532,-0.07855327427387238,-0.4439423978328705,1.099806547164917,-0.6865937113761902,-0.19636347889900208,0.16010379791259766,0.4755159914493561,0.8275705575942993,0.3734543025493622,-0.19382072985172272,-1.1013609170913696,0.4655303955078125,-0.4615223705768585,0.029980260878801346,-0.12803228199481964,-0.6200829744338989,-0.22082911431789398,-0.6129460334777832,-0.440936803817749,-0.12251780182123184,0.25749075412750244,-0.21793797612190247,-0.31565356254577637,-1.0452193021774292,0.48470351099967957,1.489746332168579,0.34717267751693726,-0.11593799293041229,0.5712113380432129,0.37145087122917175,-0.1405247449874878,0.10602741688489914,0.44691920280456543,0.2407248467206955,0.1857607066631317,-0.4698955714702606,-0.6073989272117615,0.003017023205757141,-0.692069411277771,-0.056892529129981995,0.2016339898109436,-0.6986490488052368,-0.4357801079750061,-0.3368676006793976,-0.21542751789093018,0.16499149799346924,-0.49468180537223816,0.7049293518066406,0.35484278202056885,-0.12084715068340302,-2.1006436347961426,0.17676638066768646,1.0268604755401611,-0.1937757432460785,-0.3107340335845947,-0.12163938581943512,0.4608701467514038,-0.5104370713233948,0.41666844487190247,-0.25553765892982483,1.501641869544983,0.391608864068985,-0.5072856545448303,-0.3386199176311493,0.35516029596328735,0.4765162467956543,-0.1931939572095871,-0.04903487116098404,-0.11199391633272171,-0.31363174319267273,-0.16184554994106293,1.0071266889572144,1.2638416290283203,1.3507024049758911,0.7613588571548462,0.4123046398162842,0.2764201760292053,-0.6620365977287292,-0.957791805267334,0.1179533302783966,0.05718009173870087,-0.5120300054550171,0.683925211429596,-0.38944295048713684,-0.40000054240226746,-0.1454511433839798,0.30291903018951416,-0.36079010367393494,-0.48647207021713257,0.13034778833389282,1.8149853944778442,0.11981132626533508,-0.16857168078422546,0.27804651856422424,-0.248652383685112,-0.22382158041000366,-0.02025716006755829,0.23994572460651398,-0.38804712891578674,0.15800036489963531,-0.7771037817001343,0.3905825614929199,-0.7868342995643616,-0.009819000959396362,-0.2602401375770569,0.5894878506660461,0.41537952423095703,0.20397962629795074,0.858824610710144,0.4924372136592865,-0.09800249338150024,0.33428242802619934,-0.15497006475925446,-0.18699677288532257,-0.10839053988456726]}},true]},{"type":"Workflow","content":[{"workflow":{"name":"RAG","version":"v0.1","steps":[{"name":"Initialize","body":[{"type":"composite","value":[{"type":"registeroperation","value":{"register":"$FILE_PIECES","value":{"name":"process_embeddings_in_job_scope_with_metadata","args":[]}}},{"type":"registeroperation","value":{"register":"$LLM_INPUT","value":{"name":"generate_json_map","args":[{"type":"string","value":"question"},{"type":"register","value":"$INPUT"},{"type":"string","value":"documents"},{"type":"register","value":"$FILE_PIECES"}]}}},{"type":"registeroperation","value":{"register":"$LLM_RESPONSE","value":{"name":"baml_answer_with_citations","args":[{"type":"register","value":"$LLM_INPUT"}]}}},{"type":"registeroperation","value":{"register":"$JINJA","value":"# Introduction\\n{%- for sentence in answer.brief_introduction.sentences %}\\n{{ sentence }}\\n{%- endfor %}\\n\\n# Body\\n{%- for section in answer.extensive_body %}\\n## Section {{ loop.index }}\\n{%- for sentence in section.sentences %}\\n{{ sentence }}\\n{%- endfor %}\\n{%- endfor %}\\n\\n# Conclusion\\n{%- for section in answer.conclusion %}\\n{{ section.sentences[0] }}\\n{%- endfor %}\\n\\n# Citations\\n{%- for citation in relevantSentencesFromText %}\\n[{{ citation.citation_id }}]: {{ citation.relevantSentenceFromDocument }}\\n{%- endfor %}"}},{"type":"registeroperation","value":{"register":"$RESULT","value":{"name":"shinkai__json-to-md","args":[{"type":"string","value":"message"},{"type":"register","value":"$LLM_RESPONSE"},{"type":"string","value":"template"},{"type":"register","value":"$JINJA"}]}}}]}]}],"raw":"\n            workflow RAG v0.1 {\n                step Initialize {\n                    $FILE_PIECES = call process_embeddings_in_job_scope_with_metadata()\n                    \n                    $LLM_INPUT = call generate_json_map(\"question\", $INPUT, \"documents\", $FILE_PIECES)\n                    \n                    $LLM_RESPONSE = call baml_answer_with_citations($LLM_INPUT)\n                    \n                    $JINJA = \"# Introduction\\n{%- for sentence in answer.brief_introduction.sentences %}\\n{{ sentence }}\\n{%- endfor %}\\n\\n# Body\\n{%- for section in answer.extensive_body %}\\n## Section {{ loop.index }}\\n{%- for sentence in section.sentences %}\\n{{ sentence }}\\n{%- endfor %}\\n{%- endfor %}\\n\\n# Conclusion\\n{%- for section in answer.conclusion %}\\n{{ section.sentences[0] }}\\n{%- endfor %}\\n\\n# Citations\\n{%- for citation in relevantSentencesFromText %}\\n[{{ citation.citation_id }}]: {{ citation.relevantSentenceFromDocument }}\\n{%- endfor %}\"\n                    \n                    $RESULT = call shinkai__json-to-md(\"message\",$LLM_RESPONSE,\"template\",$JINJA)\n                }\n            } @@official.shinkai\n        ","description":"Generates an answer to a question with citations from the provided content using RAG workflow.","author":"@@official.shinkai","sticky":false},"embedding":{"id":"","vector":[0.3264797627925873,0.6052402257919312,-0.08838757872581482,0.2322770357131958,-0.5915845632553101,-0.04368985444307327,-1.2123489379882812,0.0267048180103302,0.46233847737312317,-0.028976384550333023,-0.23306003212928772,0.8775257468223572,0.34762415289878845,0.17380496859550476,0.2553696632385254,0.12933200597763062,-0.06717750430107117,-0.6935021877288818,-1.494844675064087,-0.011394456028938293,0.4565299153327942,0.4279453158378601,0.15568602085113525,-0.029051296412944794,-0.27602824568748474,0.33154064416885376,0.2512126863002777,-0.10763468593358994,-1.2480343580245972,-1.8030340671539307,0.3832242488861084,0.37260785698890686,-0.4172326922416687,-0.4720008671283722,-0.13194310665130615,-0.43950921297073364,0.001856203773058951,0.14273804426193237,-0.6191220879554749,0.24850581586360931,0.06531619280576706,0.29962030053138733,0.1588892936706543,0.16487258672714233,0.4343034625053406,-0.581734299659729,0.406770259141922,-0.45346367359161377,0.3900458812713623,0.2095755934715271,-0.6586560606956482,-0.6087415218353271,0.3691110908985138,0.4626093804836273,-0.44294941425323486,0.28811395168304443,0.4716208577156067,0.004851225763559341,0.49684518575668335,-0.038454048335552216,0.3979896903038025,0.1805819869041443,-4.4982805252075195,0.5074162483215332,0.08056776970624924,0.06798148155212402,0.37245193123817444,-0.1326691210269928,-0.02521642856299877,0.030897080898284912,-0.06098252534866333,-0.2569488286972046,-0.21478590369224548,-0.05605834722518921,-0.02764083445072174,-0.3553803265094757,-0.3064717650413513,0.07025354355573654,0.3963940143585205,-0.6175645589828491,-0.07276612520217896,0.592605710029602,0.11708809435367584,0.0417887307703495,-0.7172545194625854,0.4049193561077118,-0.36222130060195923,-0.3306307792663574,0.23741118609905243,0.47863325476646423,-0.22743389010429382,-0.09804314374923706,0.38853827118873596,-0.2796548306941986,-0.498765766620636,0.25627416372299194,0.07142673432826996,0.29684144258499146,0.3757385015487671,3.215141773223877,0.20312011241912842,-0.6196138262748718,0.7082496881484985,-0.761162281036377,0.2293570339679718,-0.587596595287323,0.22240744531154633,-0.18588854372501373,0.3123873472213745,0.5502053499221802,0.19838498532772064,-0.36524301767349243,-0.27119389176368713,0.4646731913089752,0.5151158571243286,0.04511918127536774,-0.4748515486717224,0.03356776013970375,-0.1869903951883316,0.8342957496643066,-0.26072150468826294,-0.011738184839487076,-0.38192373514175415,-0.2593814730644226,0.3734847903251648,0.4604232907295227,0.03184940293431282,0.2125272899866104,0.29142552614212036,0.263128399848938,0.2948923707008362,-0.36832764744758606,-1.030495047569275,-0.11100795865058899,-0.2726568579673767,0.23690947890281677,0.9641664028167725,-0.6825208067893982,0.2355262041091919,-0.7954396605491638,-0.06666058301925659,-1.1485283374786377,0.7713145613670349,0.23018789291381836,0.5262817144393921,-0.10779017210006714,-0.856001079082489,0.2630016505718231,-0.6368698477745056,0.09511351585388184,-0.35036686062812805,0.22286269068717957,-0.3424697816371918,0.0911654680967331,0.8242197632789612,-0.1238294392824173,-0.5630863308906555,0.0007122233510017395,-0.5012823939323425,0.2977387309074402,-0.3769890069961548,-0.3523453176021576,0.5293335914611816,0.13736145198345184,0.43596524000167847,-0.16486014425754547,0.22288919985294342,-0.015766281634569168,0.4096457064151764,-0.44128188490867615,0.25367671251296997,0.05341789498925209,0.1546356976032257,0.5948237776756287,-0.2969697415828705,-0.010816741734743118,0.018274106085300446,0.135623037815094,-0.07625912129878998,-0.3131198287010193,0.7826070785522461,0.35047614574432373,-0.36469995975494385,-0.17949041724205017,-0.08755603432655334,0.35411500930786133,0.5309076309204102,0.15411114692687988,0.7076097726821899,0.8691877126693726,-0.4564625322818756,1.3150970935821533,-0.5303483009338379,0.06065240502357483,0.26967838406562805,-0.12217947095632553,0.1004878580570221,0.15800072252750397,0.9680444598197937,-0.1979808658361435,0.4702289402484894,0.28666478395462036,0.38202667236328125,-0.16305077075958252,0.24903321266174316,-0.43068206310272217,-0.1978066861629486,0.2972709536552429,-0.41837453842163086,-0.7112369537353516,-0.1107989251613617,-0.6839892864227295,0.696219801902771,0.5221155881881714,0.2960105538368225,0.3499150276184082,-0.0794273316860199,-0.212468683719635,0.45576828718185425,0.4317437708377838,-0.32402288913726807,0.1452396959066391,-0.011959865689277649,-0.5864479541778564,-0.42766591906547546,0.6707659363746643,-0.13050594925880432,-0.1180577278137207,-0.1653956174850464,-0.33208268880844116,0.2788654565811157,0.8057324290275574,0.5520050525665283,1.2830705642700195,0.7093963623046875,0.2840104401111603,-0.4082257151603699,0.27542799711227417,0.4873925745487213,-0.2522101104259491,0.11907622218132019,0.028363190591335297,0.20635758340358734,-0.18819499015808105,0.2246723771095276,-0.6655619144439697,-0.10446103662252426,-0.23150765895843506,0.09669044613838196,1.7576770782470703,0.14994856715202332,-0.32084840536117554,0.7115395665168762,0.36207491159439087,0.02094719558954239,0.24793824553489685,-1.9055274724960327,-0.23836877942085266,-0.46155938506126404,0.8016499280929565,0.17974653840065002,-0.37561920285224915,0.6458562016487122,0.06742709130048752,0.020449098199605942,-0.3048936128616333,-0.8961384296417236,-0.7088284492492676,-0.14746157824993134,-0.11284986883401871,-0.6528003215789795,0.7336992025375366,-0.5682182908058167,0.20981866121292114,-0.05374544858932495,0.1252681165933609,0.2656119167804718,0.20380675792694092,-0.6086755990982056,-0.523114025592804,0.4418862462043762,-0.2729118764400482,-0.36117568612098694,0.06014471501111984,-0.30588769912719727,-0.15482869744300842,-0.6516886353492737,-0.25265225768089294,-0.11693356186151505,-0.04211577773094177,-0.189766526222229,-0.6128356456756592,-0.6885031461715698,0.377397358417511,1.935836911201477,0.19929981231689453,0.03032916784286499,0.1991160809993744,0.38732442259788513,-0.21676932275295258,0.3985392153263092,0.15045830607414246,-0.3452260196208954,-0.21982476115226746,-0.7910107970237732,0.06679975241422653,0.26968473196029663,-0.3831362724304199,-0.0238817036151886,0.4238829016685486,-0.35494935512542725,-0.1918790191411972,0.04105297103524208,0.3055642247200012,0.5485197901725769,-0.4098147749900818,0.04434345290064812,0.2721412181854248,-0.25551414489746094,-2.419203519821167,0.050775185227394104,0.5076777338981628,-0.12216608226299286,-0.1892971396446228,-0.2650960683822632,0.5755186676979065,0.016198452562093735,0.12278316915035248,-0.60592120885849,1.5143930912017822,0.7156854271888733,-0.1529489904642105,-0.41207754611968994,-0.06407853215932846,0.8137408494949341,-0.03840029612183571,0.46164533495903015,-0.1498732566833496,-0.25452086329460144,-0.47752946615219116,0.658669650554657,1.339207649230957,0.48996442556381226,0.6034058928489685,0.05065757408738136,0.16774341464042664,-0.778769314289093,-1.26719331741333,0.21318112313747406,0.162215456366539,-0.49841317534446716,0.8600791692733765,-0.41512513160705566,-0.6178964972496033,-0.0024829544126987457,0.7752062678337097,0.02650533616542816,0.24390414357185364,0.0432179756462574,1.8687701225280762,-0.347438246011734,-0.42003199458122253,-0.14850477874279022,-0.1337883472442627,-0.4191751182079315,0.32700586318969727,0.06828166544437408,-0.6720443367958069,0.3062012791633606,-0.2570558488368988,0.28694143891334534,-0.6853766441345215,-0.03619381785392761,-0.3193512260913849,0.3563652038574219,0.07374319434165955,0.19840386509895325,0.6513432264328003,0.5856884717941284,-0.11430320143699646,0.17541953921318054,-0.2967044711112976,-0.5660766959190369,0.15609338879585266]}},true]}]"###;
